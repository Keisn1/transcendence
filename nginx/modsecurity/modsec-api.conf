# Enable ModSecurity
SecRuleEngine On

# Default logging
SecDebugLog /var/log/nginx/modsec_debug.log
SecDebugLogLevel 0
SecAuditEngine RelevantOnly
SecAuditLog /var/log/nginx/modsec_audit.log
SecAuditLogParts ABIJDEFHZ

# Allow JSON request body parsing
SecRule REQUEST_HEADERS:Content-Type "application/json" \
     "id:1000,phase:1,t:none,t:lowercase,pass,nolog,ctl:requestBodyProcessor=JSON"

# Disable rules that break API auth (adjust as needed)
SecRuleRemoveById 942100 942110 942120 942130 942200 942210 942260 949110
