
# Engine ON = enforce rules, DetectionOnly = log only
SecRuleEngine On

# Audit logging
SecAuditEngine RelevantOnly
SecAuditLog /var/log/modsec_audit.log

# Request body limits
SecRequestBodyLimit        13107200
SecRequestBodyNoFilesLimit 131072

# === Example custom rule =============================================
# This rule blocks very old curl versions
SecRule REQUEST_HEADERS:User-Agent "@rx curl/7\.[0-3][0-9]" \
    "id:900001,phase:1,deny,status:403,log,msg:'Blocked outdated curl client'"

# ---------------------------------------------------------------------
# Placeholder for more custom rules
# Every rule MUST have a unique id >= 100000
# Example:
# SecRule REQUEST_HEADERS:Content-Type "text/plain" \
#    "id:900002,phase:1,deny,status:403,log,msg:'Blocked text/plain uploads'"

# ---------------------------------------------------------------------
# OWASP CRS (disabled for now until added correctly)
# Uncomment these ONLY after installing the CRS properly
# Include /opt/crs/crs-setup.conf
# Include /opt/crs/rules/*.conf
