<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pong in JavaScript</title>
    <style>
      * { margin: 0; padding: 0; }
      canvas { display: block; background: #000; }
    </style>
  </head>
  <body>
    <canvas id="canvas"></canvas>

    <script>
      const canvas = document.getElementById('canvas');
      const ctx = canvas.getContext('2d');
      canvas.width  = window.innerWidth;
      canvas.height = window.innerHeight;

      class Ball {
        constructor(x, y, r, vx, vy) {
          this.x = x; this.y = y;
          this.r = r;
          this.vx = vx; this.vy = vy;
        }
        update() {
          this.x += this.vx;
          this.y += this.vy;
          if (this.y - this.r < 0 || this.y + this.r > canvas.height) {
            this.vy *= -1; // bounce
          }
        }
        draw() {
          ctx.beginPath();
          ctx.fillStyle = '#fff';
          ctx.arc(this.x, this.y, this.r, 0, Math.PI*2);
          ctx.fill();
        }
      }

      class Paddle {
        constructor(x) {
          this.w = 10; this.h = 100;
          this.x = x;
          this.y = (canvas.height - this.h)/2;
          this.speed = 5;
        }
        move(dy) {
          this.y = Math.max(0, Math.min(canvas.height - this.h, this.y + dy));
        }
        draw() {
          ctx.fillStyle = '#fff';
          ctx.fillRect(this.x, this.y, this.w, this.h);
        }
      }

      const ball   = new Ball(canvas.width/2, canvas.height/2, 10, 4, 4); // x position, y position, radius, x velocity, y velocity
      const leftP  = new Paddle(20); // 20 pixels away from left boarder
      const rightP = new Paddle(canvas.width - 20 - 10); // 20 pixels away from right boarder + 10 pixels for paddel width

      const keys = {};
      window.addEventListener('keydown', e => { keys[e.key] = true; });
      window.addEventListener('keyup',   e => { keys[e.key] = false; });

      function handleInput() { // moving paddels
        // W / S
        if (keys['w']) leftP.move(-leftP.speed);
        if (keys['s']) leftP.move(leftP.speed);
        // ↑ / ↓
        if (keys['ArrowUp'])   rightP.move(-rightP.speed);
        if (keys['ArrowDown']) rightP.move(rightP.speed);
      }

      function checkPaddleCollision(paddle) {
        if (
          ball.x - ball.r < paddle.x + paddle.w &&
          ball.x + ball.r > paddle.x &&
          ball.y + ball.r > paddle.y &&
          ball.y - ball.r < paddle.y + paddle.h
        ) {
          ball.vx *= -1;
        }
      }

      function gameLoop() {
        ball.update();
        handleInput();
        checkPaddleCollision(leftP);
        checkPaddleCollision(rightP);

        ctx.clearRect(0, 0, canvas.width, canvas.height); // clean previous drawings
        ball.draw();
        leftP.draw();
        rightP.draw();

        requestAnimationFrame(gameLoop);
      }

      gameLoop();
    </script>
  </body>
</html>
